---
title: 第六章 符号与符号属性
abbrlink: 67215a69
date: 2019-03-30 22:20:15
categories:
  - JavaScript
  - 《深入理解ES6》
---

在JS已有的基本类型之外，ES6引入了一种新的进本类型：符号（Symbol）。符号起初被设计用于创建对象私有成员，而这也是JS开发者期待已久的特性。

# 创建符号值

**符号没有字面量形式**，这在JS的基本类型中是独一无二的。你可以使用全局`Symbol`函数来创建一个符号值，正如下面这个例子：

```js
let firstName = Symbol()
let person = {}

person[firstName] = 'Nicholas'
console.log(person[firstName])  // Nicholas
```

此代码创建了一个符号类型的`firstName`变量，并将它作为`person`对象的一个属性，而每次访问该属性都要使用这个符号值。

**由于符号值是基本类型的值，因此调用`new Symbol()`将会抛出错误。你可以通过`new Object(yourSymbol)`来创建一个符号实例，但尚不清楚这能有什么作用。**

`Symbol`函数还可以接受一个额外的参数用于描述符号值，给描述并不能用来访问对应属性，但它能用于调试，例如：

```js
let firstName = Symbol('first name')
let person = {}

person[firstName] = 'Nicholas'

console.log('first name' in person)     // false
console.log(person[firstName])          // Nicholas
console.log(firstName)                  // Symbol(first name)
```

符号的描述信息被存储在内部属性`[[Description]]`中，当符号的`toString()`方法被显式或隐式调用时，该属性都会被读取。

由于符号是基本类型的值，你可以使用`typeof`运算符来判断一个变量是否为符号。ES6扩充了`typeof`的功能以便让它在作用于符号值的时候能够返回`symbol`。

# 使用符号值

你可以在任意能使用“需计算属性名”的场合使用符号。此外还可以在`Object.defineProperty()`或`Object.defineProperties()`调用中使用它。

**由于符号不存在字面量形式，所以如果以符号作为对象的属性名，就算该属性的`enumerable`被设置为`true`，该属性也无法用`for-in`循环，并且不会显示在`Object.keys()`的结果中。但是你可以使用`in`操作符来判断该属性是否存在！**

```js
let firstName = Symbol('first name')
let person = {
    [firstName]: 'Nicholas',
    normalAttr: 1
}

let desc = Object.getOwnPropertyDescriptor(person, firstName)

console.log(desc.value)             // true
console.log(desc.writable)          // true
console.log(desc.enumerable)        // true
console.log(desc.configurable)      // true

console.log(firstName in person)    // true
console.log(Object.keys(person))    // [ 'normalAttr' ]

for (let key in person) {
    console.log(key)    
}
// Nicholas
```

# 共享符号值

# 符号值的转换

# 检索符号属性

# 使用知名符号暴露内部方法
## hasInstance
## isConcatSpreadable
## math、replace、search与split
## toPrimitive
## toStringTag
### 识别问题的变通解决方案
### ES6给出的答案
## unscopables