---
title: 第二十三章 客户端存储
categories:
  - JavaScript
  - 《JavaScript高级程序设计》
abbrlink: 4fd0352
date: 2019-05-22 20:39:34
---

# Cookie

## 为什么需要Cookie

以下描述摘抄自[**认识HTTP----Cookie和Session篇**](https://zhuanlan.zhihu.com/p/27669892)

HTTP是无状态协议，说明它不能以状态来区分和管理请求和响应。也就是说，无法根据之前的状态进行本次的请求处理。

我们登陆淘宝的时候首先要登陆，我们看到了一个商品点进去，进行了页面跳转/刷新，按照HTTP的无状态协议岂不是又要登陆一次？

所以为了解决这个问题，Cookie诞生了。

## Cookie简介

{% note info %}
Cookie的使用顺序如下：
1. 浏览器在没有Cookie的状态下向服务器发送请求
2. 服务器在响应头部添加`Set-Cookie`字段，浏览器接收后将其保存下来
3. 浏览器再向该服务器发送请求时，会自动在请求头部添加`Cookie`字段
4. 服务器通过请求头部的`Cookie`认出了发送请求的浏览器

---
Cookie的限制：
- 每个域名下能保存的Cookie个数是有上限的，不同浏览器情况不一样
- Cookie的大小有限制，最好将每个Cookie的限制在4095B（含4095）以内

---
Cookie由浏览器保存的以下几块信息构成：
- **名称**：一个唯一确定Cookie的名称，不区分大小写，然而实践中最好将名称看做是区分大小写的，且名称必须是经过URL编码的
- **值**：储存在Cookie中的字符串值，必须是被URL编码的
- **域**：Cookie对于哪个域是有效的。所有向该域发送的请求中都会包含这个Cookie信息
- **路径**：对于指定域中的那个路径，应该向服务器发送Cookie。例如，你可以指定Cookie只有从`https://www.wrox.com/books/`中才能访问，那么`https://www.wrox.com`的页面就不会发送Cookie信息，即使请求都是来自同一个域的
- **失效时间**：表示Cookie何时应该被删除的时间戳。默认情况下，浏览器会话结束时会将所有Cookie删除，不过也可以自己设置删除时间
- **安全标志**：指定后，Cookie只有在使用SSL连接的时候才发送到服务器。例如，Cookie信息只能发送给`https://www.wrox.com`，而`http://www.wrox.com`的请求则不能发送Cookie

每一段信息都作为`Set-Cookie`的一部分，使用分号加空格号分隔每一段
`Set-Cookie: myCookieName=myCookieValue; expires=Mon, 22-Jan-20 00:00:00 GMT; domain=.wrox.com; path=/;`
{% endnote %}

## JavaScript中的Cookie
